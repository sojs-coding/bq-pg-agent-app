sources:
  bq_source:
    kind: bigquery
    project: ${BIGQUERY_PROJECT}
    writeMode: blocked
  pg_source:
    kind: cloud-sql-postgres
    project: ${PG_PROJECT}
    region: us-central1
    instance: ${PG_INSTANCE}
    database: ${PG_DB}
    user: ${PG_USER_NAME}
    password: ${PG_PASSWORD}
    # ipType: "private"

tools:
  bigquery-execute-sql:
    kind: bigquery-execute-sql
    source: bq_source
    description: "Executes a SQL statement against BigQuery and returns the raw data."
  bigquery-conversational-analytics:
    kind: bigquery-conversational-analytics
    source: bq_source
    description: "Use this tool to perform data analysis, get insights, or answer complex questions about the contents of specific BigQuery tables."
  bigquery-analyze-contribution:
    kind: bigquery-analyze-contribution
    source: bq_source
    description: Use this tool to run contribution analysis on a dataset in BigQuery.
  bigquery-forecast:
    kind: bigquery-forecast
    source: bq_source
    description: "Forecasts time series data in BigQuery."
  bigquery-get-dataset-info:
    kind: bigquery-get-dataset-info
    source: bq_source
    description: "Retrieves metadata for a BigQuery dataset."
  bigquery-get-table-info:
    kind: bigquery-get-table-info
    source: bq_source
    description: "Retrieves metadata for a BigQuery table."
  bigquery-list-dataset-ids:
    kind: bigquery-list-dataset-ids
    source: bq_source
    description: "Returns all dataset IDs from the source."
  bigquery-list-table-ids:
    kind: bigquery-list-table-ids
    source: bq_source
    description: "Returns table IDs in a given BigQuery dataset."
  bigquery-search-catalog:
    kind: bigquery-search-catalog
    source: bq_source
    description: "Allows to search for entries based on the provided query."
  postgres-execute-sql:
    kind: postgres-execute-sql
    source: pg_source
    description: Use this tool to execute sql statement.
  postgres-list-tables:
    kind: postgres-list-tables
    source: pg_source
    description: Use this tool to retrieve schema information for all or specified tables. Output format can be simple (only table names) or detailed.
  postgres-list-active-queries:
    kind: postgres-list-active-queries
    source: pg_source
    description: List the top N (default 50) currently running queries (state='active') from pg_stat_activity, ordered by longest-running first. Returns pid, user, database, application_name, client_addr, state, wait_event_type/wait_event, backend/xact/query start times, computed query_duration, and the SQL text.
  postgres-list-available-extensions:
    kind: postgres-list-available-extensions
    source: pg_source
    description: Discover all PostgreSQL extensions available for installation on this server, returning name, default_version, and description.
  postgres-list-installed-extensions:
    kind: postgres-list-installed-extensions
    source: pg_source
    description: List all installed PostgreSQL extensions with their name, version, schema, owner, and description.
  postgres-list-views:
    kind: postgres-list-views
    source: pg_source
    description: List views in a PostgreSQL database.
  postgres-list-schemas:
    kind: postgres-list-schemas
    source: pg_source
    description: "Lists all schemas in the database ordered by schema name and excluding system and temporary schemas. It returns the schema name, schema owner, grants, number of functions, number of tables and number of views within each schema."
  postgres-database-overview:
    kind: postgres-database-overview
    source: pg_source
    description: fetches the current state of the PostgreSQL server. It returns the postgres version, whether it's a replica, uptime duration, maximum connection limit, number of current connections, number of active connections and the percentage of connections in use.
  postgres-list-triggers:
    kind: postgres-list-triggers
    source: pg_source
    description: |
        Lists all non-internal triggers in a database. Returns trigger name, schema name, table name, wether its enabled or disabled,  timing (e.g BEFORE/AFTER of the event), the  events that cause the trigger to fire such as INSERT, UPDATE, or DELETE, whether the trigger activates per ROW or per STATEMENT, the handler function executed by the trigger and full definition.
  postgres-list-indexes:
    kind: postgres-list-indexes
    source: pg_source
    description: |
      Lists available user indexes in the database, excluding system schemas (pg_catalog, 
      information_schema). For each index, the following properties are returned: 
      schema name, table name, index name, index type (access method), a boolean 
      indicating if it's a unique index, a boolean indicating if it's for a primary key,
      the index definition, index size in bytes, the number of index scans, the number of 
      index tuples read, the number of table tuples fetched via index scans, and a boolean 
      indicating if the index has been used at least once.
  postgres-list-sequences:
    kind: postgres-list-sequences
    source: pg_source
    description: |
        Lists all the sequences in the database ordered by sequence name.
        Returns sequence name, schema name, sequence owner, data type of the
        sequence, starting value, minimum value, maximum value of the sequence,
        the value by which the sequence is incremented, and the last value
        generated by generated by the sequence in the current session.
  postgres-long-running-transactions:
    kind: postgres-long-running-transactions
    source: pg_source
    description: "Identifies transactions open longer than a threshold and returns details including query text and durations."
  postgres-list-locks:
    kind: postgres-list-locks
    source: pg_source
    description: "Lists active locks with associated process and query information."
  postgres-replication-stats:
    kind: postgres-replication-stats
    source: pg_source
    description: "Lists replication connections and readable WAL lag metrics."
  postgres-list-query-stats:
    kind: postgres-list-query-stats
    source: pg_source
    description: List query statistics from pg_stat_statements, showing performance metrics for queries including execution counts, timing information, and resource usage. Results are ordered by total execution time descending.
  postgres-get-column-cardinality:
    kind: postgres-get-column-cardinality
    source: pg_source
    description: Estimates the number of unique values (cardinality) quickly for one or all columns in a specific PostgreSQL table by using the database's internal statistics, returning the results in descending order of estimated cardinality. Please run ANALYZE on the table before using this tool to get accurate results. The tool returns the column_name and the estimated_cardinality. If the column_name is not provided, the tool returns all columns along with their estimated cardinality.
  postgres-list-publication-tables:
    kind: postgres-list-publication-tables
    source: pg_source
    description: |
      Lists all tables that are explicitly part of a publication in the database.
      Tables that are part of a publication via 'FOR ALL TABLES' are not included,
      unless they are also explicitly added to the publication.
      Returns the publication name, schema name, and table name, along with
      definition details indicating if it publishes all tables, whether it
      replicates inserts, updates, deletes, or truncates, and the publication
      owner.
  postgres-list-tablespaces:
    kind: postgres-list-tablespaces
    source: pg_source
    description: |
      Lists all tablespaces in the database. Returns the tablespace name,
      owner name, size in bytes(if the current user has CREATE privileges on
      the tablespace, otherwise NULL), internal object ID, the access control
      list regarding permissions, and any specific tablespace options.

toolsets:
  bq_conversational_toolset:
    - bigquery-conversational-analytics
  bq_data_retrieval_toolset:
    - bigquery-execute-sql
    - bigquery-get-dataset-info
    - bigquery-get-table-info
    - bigquery-list-dataset-ids
    - bigquery-list-table-ids
    - bigquery-search-catalog
  bqml_analysis_toolset:
    - bigquery-forecast
    - bigquery-analyze-contribution
  bqml_toolset:
    - bigquery-execute-sql
  pg_data_retrieval_toolset:
    - postgres-list-tables
    - postgres-list-schemas
    - postgres-list-views
    - postgres-get-column-cardinality
    - postgres-list-tablespaces
    - postgres-list-publication-tables
    - postgres-database-overview
  pg_stats_toolset:
    - postgres-list-active-queries
    - postgres-list-available-extensions
    - postgres-list-installed-extensions
    - postgres-list-triggers
    - postgres-list-indexes
    - postgres-list-sequences
    - postgres-long-running-transactions
    - postgres-list-locks
    - postgres-replication-stats
    - postgres-list-query-stats
  pg_sql_toolset:
    - postgres-execute-sql